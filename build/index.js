(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var a in r)e.o(r,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:r[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Chatbot:()=>T,createChatBotMessage:()=>c,createClientMessage:()=>u,createCustomMessage:()=>l,default:()=>x,useChatbot:()=>k});const r=require("react");var a=e.n(r);const o=require("react-conditionally-render");var n=e.n(o),s=function(){return s=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s.apply(this,arguments)},i=function(e,t){return{message:e,type:t,id:Math.round(Date.now()*Math.random())}},c=function(e,t){return s(s(s({},i(e,"bot")),t),{loading:!1})},l=function(e,t,r){return s(s({},i(e,t)),r)},u=function(e,t){return s(s({},i(e,"user")),t)},m=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e)return e.apply(void 0,t)};const d=function(e){var t=e.message,r=e.customComponents;return a().createElement("div",{className:"react-chatbot-kit-user-chat-message-container"},a().createElement(n(),{condition:!!r.userChatMessage,show:m(r.userChatMessage,{message:t}),elseShow:a().createElement("div",{className:"react-chatbot-kit-user-chat-message"},t,a().createElement("div",{className:"react-chatbot-kit-user-chat-message-arrow"}))}),a().createElement(n(),{condition:!!r.userAvatar,show:m(r.userAvatar),elseShow:a().createElement("div",{className:"react-chatbot-kit-user-avatar"},a().createElement("div",{className:"react-chatbot-kit-user-avatar-container"}))}))},g=function(){return a().createElement("div",{className:"react-chatbot-kit-chat-bot-avatar"},a().createElement("div",{className:"react-chatbot-kit-chat-bot-avatar-container"},a().createElement("p",{className:"react-chatbot-kit-chat-bot-avatar-letter"},"B")))},f=function(){return a().createElement("div",{className:"chatbot-loader-container"},a().createElement("svg",{id:"dots",width:"50px",height:"21px",viewBox:"0 0 132 58",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},a().createElement("g",{stroke:"none",fill:"none"},a().createElement("g",{id:"chatbot-loader",fill:"#fff"},a().createElement("circle",{id:"chatbot-loader-dot1",cx:"25",cy:"30",r:"13"}),a().createElement("circle",{id:"chatbot-loader-dot2",cx:"65",cy:"30",r:"13"}),a().createElement("circle",{id:"chatbot-loader-dot3",cx:"105",cy:"30",r:"13"})))))};var p=function(){return p=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},p.apply(this,arguments)};const h=function(e){var t=e.message,o=e.withAvatar,s=void 0===o||o,i=e.loading,c=e.messages,l=e.customComponents,u=e.setState,d=e.customStyles,h=e.delay,v=e.id,y=(0,r.useState)(!1),b=y[0],E=y[1];(0,r.useEffect)((function(){var e;return function(t,r){var a=750;h&&(a+=h),e=setTimeout((function(){var e=function(e,t,r){if(r||2===arguments.length)for(var a,o=0,n=t.length;o<n;o++)!a&&o in t||(a||(a=Array.prototype.slice.call(t,0,o)),a[o]=t[o]);return e.concat(a||Array.prototype.slice.call(t))}([],t,!0).map((function(e){return e.id===v?p(p({},e),{loading:!1,delay:void 0}):e}));r((function(t){return p(p({},t),{messages:e})}))}),a)}(c,u),function(){clearTimeout(e)}}),[h,v]),(0,r.useEffect)((function(){h?setTimeout((function(){return E(!0)}),h):E(!0)}),[h]);var w={backgroundColor:""},S={borderRightColor:""};return d&&(w.backgroundColor=d.backgroundColor,S.borderRightColor=d.backgroundColor),a().createElement(n(),{condition:b,show:a().createElement("div",{className:"react-chatbot-kit-chat-bot-message-container"},a().createElement(n(),{condition:s,show:a().createElement(n(),{condition:!!(null==l?void 0:l.botAvatar),show:m(null==l?void 0:l.botAvatar),elseShow:a().createElement(g,null)})}),a().createElement(n(),{condition:!!(null==l?void 0:l.botChatMessage),show:m(null==l?void 0:l.botChatMessage,{message:t,loader:a().createElement(f,null)}),elseShow:a().createElement("div",{className:"react-chatbot-kit-chat-bot-message",style:w},a().createElement(n(),{condition:i,show:a().createElement(f,null),elseShow:a().createElement("span",null,t)}),a().createElement(n(),{condition:s,show:a().createElement("div",{className:"react-chatbot-kit-chat-bot-message-arrow",style:S})}))}))})};var v=function(){return v=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},v.apply(this,arguments)},y=function(e,t,r){if(r||2===arguments.length)for(var a,o=0,n=t.length;o<n;o++)!a&&o in t||(a||(a=Array.prototype.slice.call(t,0,o)),a[o]=t[o]);return e.concat(a||Array.prototype.slice.call(t))};const b=function(e){var t=e.state,o=e.setState,s=e.widgetRegistry,c=e.messageParser,l=e.parse,u=e.customComponents,m=e.actionProvider,g=e.botName,f=e.customStyles,p=e.headerText,b=e.customMessages,E=e.placeholderText,w=e.validator,S=e.disableScrollToBottom,P=e.messageHistory,C=e.actions,M=e.messageContainerRef,O=t.messages,k=(0,r.useState)(""),N=k[0],T=k[1],x=function(){setTimeout((function(){var e;M.current&&(M.current.scrollTop=null===(e=null==M?void 0:M.current)||void 0===e?void 0:e.scrollHeight)}),50)};(0,r.useEffect)((function(){S||x()}));var j=function(e){if(e.preventDefault(),w&&"function"==typeof w){if(w(N)){if(A(),l)return l(N);c.parse(N)}}else{if(A(),l)return l(N);c.parse(N)}},A=function(){o((function(e){return v(v({},e),{messages:y(y([],e.messages,!0),[i(N,"user")],!1)})})),x(),T("")},I={backgroundColor:""};f&&f.chatButton&&(I.backgroundColor=f.chatButton.backgroundColor);var B="Conversation with ".concat(g);p&&(B=p);var H="Write your message here";E&&(H=E);var R=a().createElement("form",{className:"react-chatbot-kit-chat-input-form",onSubmit:j},a().createElement("input",{className:"react-chatbot-kit-chat-input",placeholder:H,value:N,onChange:function(e){return T(e.target.value)}}),a().createElement("button",{className:"react-chatbot-kit-chat-btn-send",style:I}));return a().createElement("div",{className:"react-chatbot-kit-chat-container"},a().createElement("div",{className:"react-chatbot-kit-chat-inner-container"},a().createElement(n(),{condition:!!u.header,show:u.header&&u.header(m),elseShow:a().createElement("div",{className:"react-chatbot-kit-chat-header"},B)}),a().createElement("div",{className:"react-chatbot-kit-chat-message-container",ref:M},a().createElement(n(),{condition:"string"==typeof P&&Boolean(P),show:a().createElement("div",{dangerouslySetInnerHTML:{__html:P}})}),O.map((function(e,r){return"bot"===e.type?a().createElement(a().Fragment,{key:e.id},function(e,r){var i;i=e.withAvatar?e.withAvatar:function(e,t){if(0===t)return!0;var r=e[t-1];return!("bot"===r.type&&!r.widget)}(O,r);var c=v(v({},e),{setState:o,state:t,customComponents:u,widgetRegistry:s,messages:O,actions:C});if(e.widget){var l=s.getWidget(c.widget,v(v({},t),{scrollIntoView:x,payload:e.payload,actions:C}));return a().createElement(a().Fragment,null,a().createElement(h,v({customStyles:f.botMessageBox,withAvatar:i},c,{key:e.id})),a().createElement(n(),{condition:!c.loading,show:l||null}))}return a().createElement(h,v({customStyles:f.botMessageBox,key:e.id,withAvatar:i},c,{customComponents:u,messages:O,setState:o}))}(e,r)):"user"===e.type?a().createElement(a().Fragment,{key:e.id},function(e){var r=s.getWidget(e.widget,v(v({},t),{scrollIntoView:x,payload:e.payload,actions:C}));return a().createElement(a().Fragment,null,a().createElement(d,{message:e.message,key:e.id,customComponents:u}),r||null)}(e)):function(e,t){return!!t[e.type]}(e,b)?a().createElement(a().Fragment,{key:e.id},function(e){var r=b[e.type],n={setState:o,state:t,scrollIntoView:x,actionProvider:m,payload:e.payload,actions:C};if(e.widget){var i=s.getWidget(e.widget,v(v({},t),{scrollIntoView:x,payload:e.payload,actions:C}));return a().createElement(a().Fragment,null,r(n),i||null)}return r(n)}(e)):void 0})),a().createElement("div",{style:{paddingBottom:"15px"}})),a().createElement(n(),{condition:!!u.inputMessage,show:u.inputMessage&&u.inputMessage({input:N,setInputValue:T,handleSubmit:j,placeholder:H}),elseShow:R})))},E=function(e){var t=e.message;return a().createElement("div",{className:"react-chatbot-kit-error"},a().createElement("h1",{className:"react-chatbot-kit-error-header"},"Ooops. Something is missing."),a().createElement("div",{className:"react-chatbot-kit-error-container"},a().createElement(h,{message:t,withAvatar:!0,loading:!1,id:1,customStyles:{backgroundColor:""},messages:[]})),a().createElement("a",{href:"https://fredrikoseberg.github.io/react-chatbot-kit-docs/",rel:"noopener norefferer",target:"_blank",className:"react-chatbot-kit-error-docs"},"View the docs"))};var w=function(e){return e.widgets?e.widgets:[]},S=function(e){try{new e}catch(e){return!1}return!0},P=function(){return P=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},P.apply(this,arguments)};const C=function(e,t){var r=this;this.addWidget=function(e,t){var a=e.widgetName,o=e.widgetFunc,n=e.mapStateToProps,s=e.props;r[a]={widget:o,props:s,mapStateToProps:n,parentProps:P({},t)}},this.getWidget=function(e,t){var a=r[e];if(a){var o,n=P(P(P(P({scrollIntoView:t.scrollIntoView},a.parentProps),"object"==typeof(o=a.props)?o:{}),r.mapStateToProps(a.mapStateToProps,t)),{setState:r.setState,actionProvider:r.actionProvider||t.actions,actions:t.actions,state:t,payload:t.payload});return a.widget(n)||null}},this.mapStateToProps=function(e,t){if(e)return e.reduce((function(e,r){return e[r]=t[r],e}),{})},this.setState=e,this.actionProvider=t};var M=function(){return M=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},M.apply(this,arguments)},O=function(e,t,r){if(r||2===arguments.length)for(var a,o=0,n=t.length;o<n;o++)!a&&o in t||(a||(a=Array.prototype.slice.call(t,0,o)),a[o]=t[o]);return e.concat(a||Array.prototype.slice.call(t))};const k=function(e){var t=e.config,o=e.actionProvider,n=e.messageParser,s=e.messageHistory,i=e.runInitialMessagesWithHistory,m=e.saveMessages,d=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(r[a[o]]=e[a[o]])}return r}(e,["config","actionProvider","messageParser","messageHistory","runInitialMessagesWithHistory","saveMessages"]),g="",f="";if(!t||!o||!n)return{configurationError:g="I think you forgot to feed me some props. Did you remember to pass a config, a messageparser and an actionprovider?"};var p=function(e,t){var r=[];return e.initialMessages||r.push("Config must contain property 'initialMessages', and it expects it to be an array of chatbotmessages."),r}(t);if(p.length)return{invalidPropsError:f=p.reduce((function(e,t){return e+t}),"")};var h=function(e){return e.state?e.state:{}}(t);s&&Array.isArray(s)?t.initialMessages=O([],s,!0):"string"==typeof s&&Boolean(s)&&(i||(t.initialMessages=[]));var v,y,b,E=a().useState(M({messages:O([],t.initialMessages,!0)},h)),P=E[0],k=E[1],N=a().useRef(P.messages),T=a().useRef(),x=a().useRef();(0,r.useEffect)((function(){N.current=P.messages})),(0,r.useEffect)((function(){s&&Array.isArray(s)&&k((function(e){return M(M({},e),{messages:s})}))}),[]),(0,r.useEffect)((function(){var e=x.current;return function(){if(m&&"function"==typeof m){var t=e.innerHTML.toString();m(N.current,t)}}}),[]),(0,r.useEffect)((function(){T.current=P}),[P]);var j=o,A=n;return S(j)&&S(A)?(v=new o(c,k,u,T.current,l,d),y=new C(k,v),b=new n(v,T.current),w(t).forEach((function(e){return null==y?void 0:y.addWidget(e,d)}))):(v=o,b=n,y=new C(k,null),w(t).forEach((function(e){return null==y?void 0:y.addWidget(e,d)}))),{widgetRegistry:y,actionProv:v,messagePars:b,configurationError:g,invalidPropsError:f,state:P,setState:k,messageContainerRef:x,ActionProvider:j,MessageParser:A}};var N=function(){return N=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},N.apply(this,arguments)};const T=function(e){var t=e.actionProvider,r=e.CustomInput,o=e.messageParser,n=e.config,s=e.headerText,i=e.placeholderText,l=e.saveMessages,u=e.messageHistory,m=e.runInitialMessagesWithHistory,d=e.disableScrollToBottom,g=e.validator,f=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(r[a[o]]=e[a[o]])}return r}(e,["actionProvider","CustomInput","messageParser","config","headerText","placeholderText","saveMessages","messageHistory","runInitialMessagesWithHistory","disableScrollToBottom","validator"]),p=k(N({config:n,actionProvider:t,messageParser:o,messageHistory:u,saveMessages:l,runInitialMessagesWithHistory:m},f)),h=p.configurationError,v=p.invalidPropsError,y=p.ActionProvider,w=p.MessageParser,P=p.widgetRegistry,C=p.messageContainerRef,M=p.actionProv,O=p.messagePars,T=p.state,x=p.setState;if(h)return a().createElement(E,{message:h});if(v.length)return a().createElement(E,{message:v});var j=function(e){return e.customStyles?e.customStyles:{}}(n),A=function(e){return e.customComponents?e.customComponents:{}}(n),I=function(e){return e.botName?e.botName:"Bot"}(n),B=function(e){return e.customMessages?e.customMessages:{}}(n);return S(y)&&S(w)?a().createElement(b,{state:T,CustomInput:r,setState:x,widgetRegistry:P,actionProvider:M,messageParser:O,customMessages:B,customComponents:N({},A),botName:I,customStyles:N({},j),headerText:s,placeholderText:i,validator:g,messageHistory:u,disableScrollToBottom:d,messageContainerRef:C}):a().createElement(y,{state:T,setState:x,createChatBotMessage:c},a().createElement(w,null,a().createElement(b,{state:T,CustomInput:r,setState:x,widgetRegistry:P,actionProvider:y,messageParser:w,customMessages:B,customComponents:N({},A),botName:I,customStyles:N({},j),headerText:s,placeholderText:i,validator:g,messageHistory:u,disableScrollToBottom:d,messageContainerRef:C})))},x=T;module.exports=t})();